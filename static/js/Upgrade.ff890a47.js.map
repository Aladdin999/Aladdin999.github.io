{"version":3,"sources":["webpack:///./src/assets/images/yes.png","webpack:///./src/views/Upgrade/index.vue?e586","webpack:///src/views/Upgrade/index.vue","webpack:///./src/views/Upgrade/index.vue?be7e","webpack:///./src/views/Upgrade/index.vue","webpack:///./src/views/Upgrade/index.vue?9e21"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$t","_l","i","key","attrs","domProps","toLevel","on","$event","changeLevel","Number","allow","upgradeLevel","approve","needAmount","staticRenderFns","mixins","data","showStatusTip","userLevel","aldToken","btnStatus","created","address","initData","methods","getUserLevel","getAllow","$ald","then","allowance","level","getUpgradeLevelAmount","getLevelAmount","watch","val","component"],"mappings":"0FAAAA,EAAOC,QAAU,kV,oECAjB,IAAIC,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,OAAO,CAACE,YAAY,kBAAkB,CAACN,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,GAAG,mBAAmBL,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACN,EAAIU,GAAG,GAAI,SAASC,GAAG,MAAO,CAACP,EAAG,QAAQ,CAACQ,IAAK,IAAMD,EAAGE,MAAM,CAAC,KAAO,QAAQ,GAAM,KAAOF,EAAG,KAAO,SAASG,SAAS,CAAC,QAAUH,GAAKX,EAAIe,SAASC,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOjB,EAAIkB,YAAYP,OAAOP,EAAG,QAAQ,CAACQ,IAAK,IAAMD,EAAGE,MAAM,CAAC,IAAO,KAAOF,IAAK,CAACP,EAAG,OAAO,CAACJ,EAAIO,GAAG,MAAMP,EAAIQ,GAAGG,MAAMP,EAAG,MAAM,CAACS,MAAM,CAAC,IAAM,EAAQ,QAAkB,IAAM,YAAaM,OAAOnB,EAAIoB,OAA2IhB,EAAG,MAAM,CAACE,YAAY,mBAAmBU,GAAG,CAAC,MAAQhB,EAAIqB,eAAe,CAACjB,EAAG,OAAO,CAACJ,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,GAAG,mBAA5OL,EAAG,MAAM,CAACE,YAAY,mBAAmBU,GAAG,CAAC,MAAQhB,EAAIsB,UAAU,CAAClB,EAAG,OAAO,CAACJ,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,GAAG,oBAAoB,YAAwI,KAAKL,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,aAAa,CAACN,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,GAAG,eAAe,OAAOL,EAAG,MAAM,CAACE,YAAY,OAAO,CAACF,EAAG,OAAO,CAACE,YAAY,SAAS,CAACN,EAAIO,GAAG,MAAMP,EAAIQ,GAAGR,EAAIe,YAAYX,EAAG,OAAO,CAACE,YAAY,WAAW,CAACN,EAAIO,GAAG,IAAIP,EAAIQ,GAAGR,EAAIS,GAAG,gBAAgB,KAAKL,EAAG,OAAO,CAACJ,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIuB,eAAevB,EAAIO,GAAG,kBAC7xCiB,EAAkB,G,4HCwCtB,GACEC,OAAQ,CAAC,EAAX,MACEC,KAFF,WAGI,MAAO,CACLC,eAAe,EACfC,UAAW,IACXb,QAAS,GACTQ,WAAY,SACZM,SAAU,KACVT,MAAO,EACPU,UAAW,IAGfC,QAbF,WAcQ9B,KAAK+B,SACP/B,KAAKgC,YAGTC,QAAS,CACPD,SADJ,WAEMhC,KAAK4B,SAAW,IAAtB,gDACA,kCACM5B,KAAKkC,eACLlC,KAAKmC,YAEPD,aAPJ,WAOA,WACMlC,KAAKoC,KAAKT,UAAU3B,KAAK+B,SAASM,MAAK,SAA7C,GACQ,EAAR,uBACQ,EAAR,yBAGIF,SAbJ,WAaA,WACMnC,KAAK4B,SAASU,UAAUtC,KAAK+B,QAAS,EAA5C,8BACQ,EAAR,uBAGIV,QAlBJ,WAkBA,WACMrB,KAAK4B,SAASP,QAAQ,EAA5B,oCACQ,EAAR,eAGIJ,YAvBJ,SAuBA,GACA,kCACQjB,KAAKc,QAAUd,KAAK2B,WAGtB3B,KAAKc,QAAUyB,EACfvC,KAAKwC,sBAAsBD,KAE7B,aA/BJ,WA+BA,8KACA,gCADA,UACA,EADA,SAEA,mDAFA,uBAGA,iBAHA,0BAMA,qEANA,8CASIC,sBAxCJ,SAwCA,cACMxC,KAAKoC,KAAKK,eAAeF,EAAOvC,KAAK+B,SAASM,MAAK,SAAzD,GACQ,EAAR,gEAIEK,MAAO,CACLX,QADJ,SACA,GACUY,GACF3C,KAAKgC,cC5GiV,I,wBCQ1VY,EAAY,eACd,EACA9C,EACAyB,GACA,EACA,KACA,WACA,MAIa,aAAAqB,E,2rGCnBf","file":"static/js/Upgrade.ff890a47.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAr0lEQVQ4T+XU0Q2CMBDG8f/JDi6hO4jGGdhRN/AFYQcZwxH0rCSSVkoLlAcT+9rk1+vd1woLL1nY409ALdnJgfrdvuQra80JZSs5m2Twg/GkMBU2SaAPmw0OYbPAEOaAeiWXPVUo6DHMBau2qY2ZVuFDx2AuWJqxrzj70LFYr4cmoD10CuYdSocKt/bqJrR2zmKfifelWJUyBQvGRi+syXjIkXusKns/+S1/H/b74At6MVYVmeOyWQAAAABJRU5ErkJggg==\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[_c('div',{staticClass:\"card-box\"},[_c('div',{staticClass:\"card-title\"},[_c('span',{staticClass:\"gradient-title\"},[_vm._v(_vm._s(_vm.$t('upgrade.t')))])]),_c('div',{staticClass:\"card-content\"},[_vm._l((7),function(i){return [_c('input',{key:(\"r\" + i),attrs:{\"type\":\"radio\",\"id\":(\"lv\" + i),\"name\":\"level\"},domProps:{\"checked\":i == _vm.toLevel},on:{\"click\":function($event){return _vm.changeLevel(i)}}}),_c('label',{key:(\"l\" + i),attrs:{\"for\":(\"lv\" + i)}},[_c('span',[_vm._v(\"LV.\"+_vm._s(i))]),_c('img',{attrs:{\"src\":require(\"images/yes.png\"),\"alt\":\"\"}})])]}),(!Number(_vm.allow))?_c('div',{staticClass:\"up-btn theme-btn\",on:{\"click\":_vm.approve}},[_c('span',[_vm._v(_vm._s(_vm.$t('upgrade.approve'))+\"ALD\")])]):_c('div',{staticClass:\"up-btn theme-btn\",on:{\"click\":_vm.upgradeLevel}},[_c('span',[_vm._v(_vm._s(_vm.$t('upgrade.t')))])])],2)]),_c('div',{staticClass:\"tip-box\"},[_c('div',{staticClass:\"tip-title\"},[_vm._v(_vm._s(_vm.$t('upgrade.tt'))+\":\")]),_c('div',{staticClass:\"tip\"},[_c('span',{staticClass:\"label\"},[_vm._v(\"Lv.\"+_vm._s(_vm.toLevel))]),_c('span',{staticClass:\"content\"},[_vm._v(\" \"+_vm._s(_vm.$t('upgrade.tip'))+\" \"),_c('span',[_vm._v(_vm._s(_vm.needAmount))]),_vm._v(\" ALD \")])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"wrapper\">\n    <div class=\"card-box\">\n      <div class=\"card-title\">\n        <span class=\"gradient-title\">{{$t('upgrade.t')}}</span>\n      </div>\n      <div class=\"card-content\">\n        <template v-for=\"i in 7\">\n          <input :checked=\"i == toLevel\" type=\"radio\" :id=\"`lv${i}`\" name=\"level\" :key=\"`r${i}`\" @click=\"changeLevel(i)\">\n          <label :for=\"`lv${i}`\" :key=\"`l${i}`\">\n            <span>LV.{{i}}</span>\n            <img src=\"~images/yes.png\" alt=\"\">\n          </label>\n        </template>\n        <div class=\"up-btn theme-btn\" @click=\"approve\" v-if=\"!Number(allow)\">\n          <span>{{$t('upgrade.approve')}}ALD</span>\n        </div>\n        <div class=\"up-btn theme-btn\" @click=\"upgradeLevel\" v-else>\n          <span>{{$t('upgrade.t')}}</span>\n        </div>\n      </div>\n    </div>\n    <div class=\"tip-box\">\n      <div class=\"tip-title\">{{$t('upgrade.tt')}}:</div>\n      <div class=\"tip\">\n        <span class=\"label\">Lv.{{toLevel}}</span>\n        <span class=\"content\">\n          {{$t('upgrade.tip')}} <span>{{needAmount}}</span> ALD\n        </span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { commonMixin } from '@/utils/mixins'\nimport { Ald, aldAddr } from '@/utils/addr'\nimport { ethers } from 'ethers'\nimport { MaxUint256 } from '@ethersproject/constants'\nimport tokenAbi from '@/abi/erc20.json'\n\nexport default {\n  mixins: [ commonMixin ],\n  data () {\n    return {\n      showStatusTip: false,\n      userLevel: '0',\n      toLevel: '',\n      needAmount: '0.0000',\n      aldToken: null,\n      allow: 0,\n      btnStatus: 0 // 0 提升 1 授权\n    }\n  },\n  created() {\n    if (this.address) {\n      this.initData()\n    }\n  },\n  methods: {\n    initData () {\n      this.aldToken = (new ethers.Contract(Ald, tokenAbi, this.$provider))\n          .connect(this.$store.state.signer)\n      this.getUserLevel()\n      this.getAllow()\n    },\n    getUserLevel () {\n      this.$ald.userLevel(this.address).then(res => {\n        this.userLevel = res.toString()\n        this.toLevel = res.toString()\n      })\n    },\n    getAllow () {\n      this.aldToken.allowance(this.address, aldAddr).then(res => {\n        this.allow = res.toString()\n      })\n    },\n    approve () {\n      this.aldToken.approve(aldAddr, MaxUint256).then(() => {\n        this.getAllow()\n      })\n    },\n    changeLevel (level) {\n      if(Number(level) <= Number(this.userLevel)) {\n        this.toLevel = this.userLevel\n        return\n      }\n      this.toLevel = level\n      this.getUpgradeLevelAmount(level)\n    },\n    async upgradeLevel () {\n       let balance = await this.aldToken.balanceOf(this.address)\n       if(Number(balance.toString()/Math.pow(10, 18)) < this.needAmount) {\n         this.$toast('余额不足')\n         return\n       }\n       this.$ald.upgradeLevel(this.toLevel, {from: this.address}).then(() => {\n        })\n    },\n    getUpgradeLevelAmount (level) {\n      this.$ald.getLevelAmount(level, this.address).then(res => {\n        this.needAmount = Number(res.toString()/Math.pow(10, 18)).toFixed(4)\n      })\n    }\n  },\n  watch: {\n    address (val) {\n      if (val) {\n        this.initData()\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.wrapper {\n  padding: 12px;\n}\n.card-box {\n  background: #fff;\n  border-radius: 5px;\n  .card-title {\n    line-height: 46px;\n    padding: 0 12px;\n    border-bottom: 1px solid #DEDEDE;\n  }\n  .card-content {\n    padding: 0 12px 20px;\n    input {\n      display: none;\n      &:checked + label {\n        color: @theme-color;\n        img {\n          display: block;\n        }\n      }\n    }\n    label {\n      height: 40px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      border-bottom: 1px solid #DEDEDE;\n      img {\n        display: none;\n      }\n    }\n    .up-btn {\n      margin-top: 20px;\n    }\n  }\n}\n.tip-box {\n  margin-top: 20px;\n  .tip-title {\n\n  }\n  .tip {\n    margin-top: 16px;\n    padding-left: 12px;\n    .label {\n      margin-right: 40px;\n    }\n    .content {\n      span {\n        color: @theme-color;\n      }\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=bdac9c4a&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=bdac9c4a&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bdac9c4a\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/style-resources-loader/lib/index.js??ref--10-oneOf-1-4!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=bdac9c4a&lang=less&scoped=true&\""],"sourceRoot":""}